@using Booking_Backend.Repository.Paging.ViewModel;
@model LocationViewModel;
@addTagHelper *, Microsoft.AspNetCore.Mvc.TagHelpers
@inject LazZiya.ExpressLocalization.ISharedCultureLocalizer _loc;
@inject Microsoft.Extensions.Configuration.IConfiguration Configuration;
@{
    var culture = CultureInfo.CurrentCulture.Name;
}
@{
    ViewData["Title"] = "Gonow.net | Chỗ nghỉ ở " + ViewData["locationName"];
    Layout = "_LayoutSearchResult";
}
<style>
    .link-hotel:hover {
       text-decoration:none;
    }
</style>
<div class="home-page-search-result" style="padding-top: 40px">
    <div class="container mt-5 mb-5">
        @* <div class="url-find-room">Trang chủ > Việt Nam > Thành phố Đà Nẵng > Đà Nẵng</div> *@
        <div class="row mb-5">
            <div class="col-md-3">
                <div class=" tabbar-left pl-5 pr-5 pt-3 pb-3">
                    <div class="mt-3" style="font-weight: 300; font-size: 25px" localize-content>Bộ lọc tự động</div>
                    @foreach (var item in Model.ListHotelType)
                    {
                        <div style="font-size: 17px" class="filter-container-hoteltype d-flex mt-2">
                            <input id="ipHotelType_@item.Id" type="checkbox" class="form-check-inline" data-hoteltypeid="@item.Id" />
                            <div class="">@item.Name</div>
                        </div>
                    }
                    <script>
                        document.addEventListener('DOMContentLoaded', function () {
                            // Lấy giá trị của tham số 'hoteltypeId' từ URL
                            var urlParams = new URLSearchParams(window.location.search);
                            var hoteltypeId = urlParams.get('HotelTypeId');

                            // Nếu hoteltypeId được tìm thấy trong URL
                            if (hoteltypeId !== null) {
                                // Lặp qua tất cả các checkbox và kiểm tra xem id của checkbox có khớp với hoteltypeId hay không
                                var checkboxes = document.querySelectorAll('input[type="checkbox"].form-check-inline');
                                checkboxes.forEach(function (checkbox) {
                                    var itemId = checkbox.getAttribute('data-hoteltypeid');
                                    if (itemId === hoteltypeId) {
                                        checkbox.checked = true; // Thêm thuộc tính 'checked' nếu id khớp
                                    }
                                });
                            }
                        });
                    </script>
                    <script>
                        document.addEventListener('DOMContentLoaded', function () {
                            var checkboxes = document.querySelectorAll('input[type="checkbox"].form-check-inline');
                            checkboxes.forEach(function (checkbox) {
                                checkbox.addEventListener('click', function () {
                                    var hotelTypeId = this.getAttribute('data-hoteltypeid');
                                    if (this.checked) {
                                        var currentUrl = window.location.href;
                                        var newUrl = currentUrl + '&HotelTypeId=' + hotelTypeId;
                                        window.location.href = newUrl;
                                    } else {
                                        // Handle case when checkbox is unchecked, if needed
                                    }
                                });
                            });
                        });
                    </script>
                    <hr />

                    <div class="mt-3" style="font-weight: 300; font-size: 25px" localize-content>Bậc hạng</div>
                    <div style="font-size: 17px" class="filter-container-hoteltype d-flex mt-2">
                        <input type="checkbox" class="form-check-inline" />
                        <div class="">9 <span localize-content>điểm trở lên</span></div>
                    </div>
                    <div style="font-size: 17px" class="filter-container-hoteltype d-flex mt-2">
                        <input type="checkbox" class="form-check-inline" />
                        <div class="">8 <span localize-content>điểm trở lên</span></div>
                    </div>
                    <div style="font-size: 17px" class="filter-container-hoteltype d-flex mt-2">
                        <input type="checkbox" class="form-check-inline" />
                        <div class="">7 <span localize-content>điểm trở lên</span></div>
                    </div>
                
                    <hr />
                </div>
            </div>
            <div class="col-md-9 main-page">
                <div class="total-properties-bylocation">
                    <span>@Model.ListHotelByLocation.Items.FirstOrDefault().Area</span> có
                    <span>@Model.ListHotelByLocation.TotalRecord</span>
                    <span localize-content>chỗ nghỉ</span>
                </div>
                <div class="navbar-main-page">
                    <div class="nav-item-title nav-item" localize-content>Sắp xếp theo</div>
                    <a href="@(Context.Request.QueryString + "&isLowPrice=true")">
                        <div class="nav-item-2 nav-item" localize-content>Giá thấp nhất</div>
                    </a>
                    <a href="@(Context.Request.QueryString + "&isHightFeedBack=true")">
                        <div class="nav-item-3 nav-item" localize-content>Đánh giá cao</div>
                    </a>
                    <a href="#">
                        <div class="nav-item-4 nav-item" localize-content>Khuyến mãi</div>
                    </a>
                </div>
                <div class="row">
                    @if(Model.ListHotelByLocation.TotalRecord > 0)
                    {
                        @foreach (var item in Model.ListHotelByLocation.Items)
                        {
                            var url = $"/{culture}/hotel/{item.Id}";
                            <div class="col-md-12 hotel-item-info">
                                <div class="hotel-info">
                                    <div class="row">
                                        <div class="col-md-4 image-location">
                                            <img src="@(Configuration["HostServer"] + item.Thumbnail)" style="height: 230px; width: 100%; object-fit:cover;" alt="">
                                        </div>
                                        <div class="col-md-6 body-card">
                                            <a class="link-hotel" href="@url" style="">
                                                <h4>@item.Name</h4>
                                                <div class="address-location d-flex">
                                                    <div>@item.Address</div>
                                                </div>
                                                    <a class="" style="color: black" href="#" localize-content>Xem bản đồ</a>
                                                <div class="short-des" style="height: 110px">
                                                    @item.ShortDescription
                                                </div>
                                            </a>
                                        </div>
                                        <div class="col-md-2 price-and-feeback">
                                            <div class="row">
                                                <div class="col-md-12 d-flex" localize-content>
                                                    Đánh giá:<strong> @(item.CountFeedback)</strong>
                                                </div>
                                            </div>
                                            <div class="row">
                                                <div class="col-md-12 d-flex" localize-content>
                                                    Số điểm: <strong>@(item.Score == null ? 0 : @item.Score)</strong>
                                                </div>
                                            </div>
                                            <div class="row">
                                                <div class="col-md-12 d-flex">
                                                    <strong class="feed-back-text">@(Math.Round((decimal)item.PriceDefault).ToString("N0")) VND</strong>
                                                </div>
                                            </div>
                                            <div class="row mt-5">
                                                <div class="col-md-12">
                                                    <a href="@url" class="">
                                                        <div class="btn btn-primary text-light" localize-content>
                                                            Hiển thị
                                                        </div>
                                                    </a>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        }
                    } else
                    {
                        <p class="ml-5 mt-3" localize-content>Không có khách sạn được tìm thấy</p>
                    }

                </div>
                <br><br>
            </div>
        </div>
    </div>
</div>

